# Net One Writeup

# `Source Code`

![source code](img/net/net1_source_code.png)

Verilen integer değerin `native endian` gösteriminin ascii eşdeğerini bulup göndermemiz beklenmekte.

AMD64 için 64001 i486 için 64011 portları kullanılmış.

![0](img/net/net1_0.png)

![1](img/net/net1_1.png)


# `Exploit`

`amd64`

    import struct
    import socket

    def read_line_from_sock(socket):
        buf = ""
        while True:
            b = s.recv(1)
            if b == b'\n':
                break
            buf += b.decode("ascii")
        return buf

    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.connect(('127.0.0.1', 64001))
        print(read_line_from_sock(s))
        query = s.recv(4)
        to_send = struct.unpack("I", query)
        print(query)
        print(to_send)
        s.send((str(to_send[0]) + "\n").encode("ascii"))
        print(read_line_from_sock(s))

`i486`

    import struct
    import socket

    def read_line_from_sock(socket):
        buf = ""
        while True:
            b = s.recv(1)
            if b == b'\n':
                break
            buf += b.decode("ascii")
        return buf

    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.connect(('127.0.0.1', 64011))
        print(read_line_from_sock(s))
        query = s.recv(4)
        to_send = struct.unpack("I", query)
        print(query)
        print(to_send)
        s.send((str(to_send[0]) + "\n").encode("ascii"))
        print(read_line_from_sock(s))
