# Heap Zero Writeup

# `Source Code`

![source code](img/heap/heap0_source_code.png)

f'in fp fonksiyon göstergesi üzerine `winner` adresimizi yazacağız.

f heap üzerinde d'den sonra gelir. d ise sınır kontrolü olmadan strcpy kullanılarak doldurulur. Bu, f-> fp'nin üzerine yazmak için d alanını taşırabileceğimiz anlamına gelir.

Yazacağımız winner adresini bulalım.

![0](img/heap/heap0_0.png)

Şimdi de kaç karakterden sonra adresimizi yazabileceğiz onu öğrenelim

![1](img/heap/heap0_1.png)

64+16 byte dan sonra adresimizi yazabiliriz gibi gözüküyor. Normalde Protostar makinesinden hatırlayacak olursanız FFFF olan kısma adresimizi little-endian olarak yazdığımızda sonuca ulaşabiliyorduk. Ancak 64 bit sürümü, winner adresini strcpy ile okunduğunda dizeyi sona erdirecek boş bayt içerdiğinden işimizi biraz daha zorlaştırıyor.

Bu yüzden winner fonksiyonuna ulaşmak için dolaylı yoldan gideceğiz. Scriptimize winner fonksiyonuna atlayan kısa bir shellcode ekleyeceğiz. Daha sonra arabellek taşmasını kullanarak boş bayt içermeyen arabelleğimizin adresiyle fp üzerine yazabiliriz.

Yani scriptimizin son hali şu şekilde olacak

![2](img/heap/heap0_2.png)

Son olarak çalıştırıp sonucumuzu görelim

![3](img/heap/heap0_3.png)
