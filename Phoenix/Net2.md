# Net Two Writeup

# `Source Code`

![source code](img/net/net2_source_code.png)

AMD64 için 64002 ve i486 için 64012 portları kullanılmış

# `Exploit`

`amd64`

    import struct
    import socket

    def read_line_from_sock(socket):
        buf = ""
        while True:
            b = s.recv(1)
            if b == b'\n':
                break
            buf += b.decode("ascii")
        return buf

    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.connect(('127.0.0.1', 64002))
        print(read_line_from_sock(s))
        print(read_line_from_sock(s))

        query = s.recv(8*8)
        to_send = 0
        print("raw query: " + str(query))

        print("long values received")
        for i in range(0, len(query), 8):
            to_send += struct.unpack("Q", query[i:i+8])[0]
            print(struct.unpack("Q", query[i:i+8])[0])

        print("sum: " + str(to_send))
        to_send &= 0xffffffffffffffff

        print("without overflow: " + str(to_send))
        s.sendall(struct.pack('Q', to_send))

        print(read_line_from_sock(s))
