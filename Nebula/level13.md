# LEVEL 13 Writeup

# `Source Code`

![source code](img/level13_source_code.png)

Bu seviye için level13 kullanıcısına geçmeniz gerekmektedi. `username : level13 password : level13` . Bu seviyeye ait dosyaları `/home/flag13` dizininde bulabilirsiniz.

Programı çalıştıran kullanıcı belirlenmiş olan kimlik ile eşleşmezse programın çalışmasını engelleyen bir güvenlik denetimi yazılmış. Bakalım ne kadar güvenlikli olmuş :)

Koda bakacak olursak `getuid()` ile alınan değer `FAKEUID` ile karşılaştırılıyor. Bu `FAKEUID` değerine ise `1000` değeri atanmış. `getuid()` ile alınan değeri değiştiren kod dosyasını `LD_PRELOAD` kullanarak yükleyebiliriz.

Şu şekilde...

![0](img/level13_0.png)

Burada hata almamızın sebebi `LD_PRELOAD` SUID ikili dosyaları(SUID binaries) ile çalışmıyormuş. O yüzden dosyamızı olduğumuz dizine kopyalayarak SUID biti ayarlanmamış bir dosya elde edelim.

![1](img/level13_1.png)

Ve işlemimiz başarıyla gerçekleşti. Artık flag13 kullanıcısı olarak sisteme giriş yapabiliriz.

![2](img/level13_2.png)
